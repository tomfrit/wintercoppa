function InputfieldRepeaterDeleteClick(d){var c=$(this).parent("label").parent("li");if(c.is(".InputfieldRepeaterNewItem")){var a=c.parent().parent().find(".InputfieldRepeaterAddItem").children("input");a.attr("value",parseInt(a.attr("value")-1));c.remove()}else{var b=c.find(".InputfieldRepeaterDelete");if(b.is(":checked")){b.removeAttr("checked");c.children("label").removeClass("ui-state-error").addClass("ui-state-default");if(c.is(".InputfieldStateCollapsed")){c.toggleClass("InputfieldStateCollapsed",100)}c.removeClass("InputfieldRepeaterDeletePending")}else{b.attr("checked","checked");c.children("label").removeClass("ui-state-default").addClass("ui-state-error");if(!c.is(".InputfieldStateCollapsed")){c.toggleClass("InputfieldStateCollapsed",100)}c.addClass("InputfieldRepeaterDeletePending")}}d.stopPropagation()}function InputfieldRepeaterInit(c){var b=c.find(".Inputfields:eq(0)");if(!b.length){return}if(b.hasClass("InputfieldRepeaterInit")){return}b.addClass("InputfieldRepeaterInit");var a=$("<i class='fa fa-trash InputfieldRepeaterTrash'></i>").css("display","block").click(InputfieldRepeaterDeleteClick);$("input.InputfieldRepeaterDelete",c).parents(".InputfieldCheckbox").hide();$(".InputfieldFieldset > .InputfieldHeader",c).addClass("ui-state-default").prepend("<i class='fa fa-fw fa-sort InputfieldRepeaterDrag'></i>").prepend(a.clone(true));$(".InputfieldRepeaterDrag",c).hover(function(){$(this).parent("label").addClass("ui-state-focus")},function(){$(this).parent("label").removeClass("ui-state-focus")});$(".InputfieldRepeaterTrash",c).hover(function(){var d=$(this).parent("label");if(!d.parent().is(".InputfieldRepeaterDeletePending")){d.addClass("ui-state-error")}},function(){var d=$(this).parent("label");if(!d.parent().is(".InputfieldRepeaterDeletePending")){d.removeClass("ui-state-error")}});b.sortable({items:"> li:not(.InputfieldRepeaterNewItem):not(.InputfieldRepeaterReady)",axis:"y",handle:".InputfieldRepeaterDrag",start:function(f,d){d.item.find(".InputfieldHeader").addClass("ui-state-highlight");d.item.find(".InputfieldTinyMCE textarea").each(function(){tinyMCE.execCommand("mceRemoveControl",false,$(this).attr("id"))})},stop:function(f,d){d.item.find(".InputfieldHeader").removeClass("ui-state-highlight");$(this).children().each(function(e){$(this).find(".InputfieldRepeaterSort").slice(0,1).attr("value",e)});d.item.find(".InputfieldTinyMCE textarea").each(function(){tinyMCE.execCommand("mceAddControl",false,$(this).attr("id"))})}});$(".InputfieldRepeaterAddLink",c).click(function(){var k=$(this).parent("p").prev("ul.Inputfields");var e=k.children(".InputfieldRepeaterReady");if(e.size()>0){e=e.slice(0,1);e.hide();e.removeClass("InputfieldRepeaterReady");e.find("input.InputfieldRepeaterDisabled").remove();e.find("input.InputfieldRepeaterPublish").attr("value",1);e.slideDown("fast",function(){$(window).resize()});e.children(".InputfieldContent").effect("highlight",{},1000);return false}var g=k.children(".InputfieldRepeaterNewItem");var f=$(this).parent().children("input");var l=g.length;if(l>1){g=g.slice(0,1)}var i=g.clone(true);var m=i.children("label");var h=m.html();var j=h.substring(h.lastIndexOf("#")+1);j=parseInt(j);h=h.replace(/#[0-9]+/,"#"+((j-1)+l));m.html(h);var d=i.attr("id")+"_";while($("#"+d).size()>0){d+="_"}i.attr("id",d);k.append(i);i.css("display","block");i.find(".InputfieldRepeaterTrash").click(InputfieldRepeaterDeleteClick);f.attr("value",l);return false})}$(document).ready(function(){$(".InputfieldRepeater").each(function(){InputfieldRepeaterInit($(this))});$(document).on("reloaded",".InputfieldRepeater",function(){InputfieldRepeaterInit($(this))})});